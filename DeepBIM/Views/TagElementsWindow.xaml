<Window x:Class="DeepBIM.Views.TagElementsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:DeepBIM.ViewModels"
        xmlns:svc="clr-namespace:DeepBIM.Services"
        mc:Ignorable="d"
        Title="Pipe Tags Tool"
        Width="765" Height="400"
        MinWidth="700" MinHeight="480"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResizeWithGrip"
        Icon="/DeepBIM;component/Resources/Icons/logo.png">

    <!-- ===== RESOURCES ===== -->
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Resources/Styles/Styles.xaml"/>
                <ResourceDictionary Source="../Resources/Styles/ComboboxStyle.xaml"/>
                <ResourceDictionary Source="../Resources/Styles/TextBlockStyle.xaml"/>
                <ResourceDictionary Source="../Resources/Styles/DataGridStyle.xaml"/>
                <ResourceDictionary Source="../Resources/Styles/CheckBoxStyle.xaml"/>
                <ResourceDictionary Source="../Resources/Styles/SliderStyle.xaml"/>
                <ResourceDictionary Source="../Resources/Styles/ColorSwatchStyle.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- Reusable Margins -->
            <Thickness x:Key="GroupPadding">12,8,12,12</Thickness>
            <Duration x:Key="AnimationDuration">0:00:0.2</Duration>
            <svc:EnumToBooleanConverter x:Key="EnumToBooleanConverter"/>
        </ResourceDictionary>
    </Window.Resources>

    <!-- ===== MAIN GRID ===== -->
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ===== SCROLLABLE CONTENT ===== -->
        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="300"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- (1) SELECT TAG TYPE -->
                <GroupBox Header="1. SELECT TAG TYPE"
                          Grid.Column="0"
                          Padding="{StaticResource GroupPadding}"
                          Margin="0,0,5,0">
                    <StackPanel>
                        <!-- Elevation Tag -->
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,12">
                            <TextBlock Text="Elevation:" 
                                       FontWeight="SemiBold" 
                                       Width="80" 
                                       VerticalAlignment="Center"/>
                            <ComboBox ItemsSource="{Binding TagFamilies}"
                                      SelectedItem="{Binding SelectedElevationTagFamily, Mode=TwoWay}"
                                      MinWidth="160"
                                      VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- Diameter Tag -->
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,0,0">
                            <TextBlock Text="Diameter:" 
                                       FontWeight="SemiBold" 
                                       Width="80" 
                                       VerticalAlignment="Center"/>
                            <ComboBox ItemsSource="{Binding TagFamilies}"
                                      SelectedItem="{Binding SelectedDiameterTagFamily, Mode=TwoWay}"
                                      MinWidth="160"
                                      VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <!-- (2) SELECT ONE OPTION -->
                <GroupBox Header="2. SELECT ONE OPTION"
                          Grid.Column="1"
                          Padding="{StaticResource GroupPadding}"
                          Margin="5,0,5,0">
                    <StackPanel>
                        <RadioButton Content="Only Elevation" 
                                     GroupName="TagOptions"
                                     Margin="0,0,0,8"
                                     IsChecked="{Binding SelectedOption, Mode=TwoWay,
                                                 Converter={StaticResource EnumToBooleanConverter},
                                                 ConverterParameter={x:Static vm:TagOption.OnlyElevation}}"/>

                        <RadioButton Content="Only Diameter" 
                                     GroupName="TagOptions"
                                     Margin="0,0,0,8"
                                     IsChecked="{Binding SelectedOption, Mode=TwoWay,
                                                 Converter={StaticResource EnumToBooleanConverter},
                                                 ConverterParameter={x:Static vm:TagOption.OnlyDiameter}}"/>

                        <RadioButton Content="Elevation - Diameter" 
                                     GroupName="TagOptions"
                                     Margin="0,0,0,8"
                                     IsChecked="{Binding SelectedOption, Mode=TwoWay,
                                                 Converter={StaticResource EnumToBooleanConverter},
                                                 ConverterParameter={x:Static vm:TagOption.ElevMinusDia}}"/>

                        <RadioButton Content="Elev - Dia by Length" 
                                     GroupName="TagOptions"
                                     Margin="0,0,0,8"
                                     IsChecked="{Binding SelectedOption, Mode=TwoWay,
                                                 Converter={StaticResource EnumToBooleanConverter},
                                                 ConverterParameter={x:Static vm:TagOption.ElevDiaByLength}}"/>

                        <RadioButton Content="Start_End Elevation" 
                                     GroupName="TagOptions"
                                     Margin="0,0,0,8"
                                     IsChecked="{Binding SelectedOption, Mode=TwoWay,
                                                 Converter={StaticResource EnumToBooleanConverter},
                                                 ConverterParameter={x:Static vm:TagOption.StartEndElevation}}"/>

                        <RadioButton Content="Start_End Elev - Dia" 
                                     GroupName="TagOptions"
                                     Margin="0,0,0,0"
                                     IsChecked="{Binding SelectedOption, Mode=TwoWay,
                                                 Converter={StaticResource EnumToBooleanConverter},
                                                 ConverterParameter={x:Static vm:TagOption.StartEndElevationMinusDia}}"/>
                    </StackPanel>
                </GroupBox>

                <!-- (3) PIPE LENGTH -->
                <GroupBox Header="3. PIPE LENGTH (m)"
                          Grid.Column="2"
                          Padding="{StaticResource GroupPadding}"
                          Margin="5,0,0,0">
                    <StackPanel>
                        <TextBox Text="{Binding Length1}" 
                                 IsEnabled="{Binding IsLen1Enabled}" 
                                 MinWidth="140"
                                 MaxLength="10"
                                 Margin="0,0,0,8"/>

                        <TextBox Text="{Binding Length2}" 
                                 IsEnabled="{Binding IsLen2Enabled}" 
                                 MinWidth="140"
                                 MaxLength="10"
                                 Margin="0,0,0,8"/>

                        <TextBox Text="{Binding Length3}" 
                                 IsEnabled="{Binding IsLen3Enabled}" 
                                 MinWidth="140"
                                 MaxLength="10"
                                 Margin="0,0,0,8"/>

                        <TextBox Text="{Binding Length4}" 
                                 IsEnabled="{Binding IsLen4Enabled}" 
                                 MinWidth="140"
                                 MaxLength="10"
                                 Margin="0,0,0,8"/>

                        <TextBox Text="{Binding Length5}" 
                                 IsEnabled="{Binding IsLen5Enabled}" 
                                 MinWidth="140"
                                 MaxLength="10"
                                 Margin="0,0,0,8"/>

                        <TextBox Text="{Binding Length6}" 
                                 IsEnabled="{Binding IsLen6Enabled}" 
                                 MinWidth="140"
                                 MaxLength="10"
                                 Margin="0,0,0,0"/>
                    </StackPanel>
                </GroupBox>
            </Grid>
        </ScrollViewer>

        <!-- ===== BUTTONS ===== -->
        <StackPanel Grid.Row="1"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,16,12,12"
                    >

            <!-- Cancel Button -->
            <Button Style="{StaticResource CancelButton}"
                    Width="110"
                    Margin="0,0,12,0"
                    IsCancel="True" Click="Button_Click">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="✖" FontSize="14" Margin="0,0,6,0"/>
                    <TextBlock Text="Cancel"/>
                </StackPanel>
            </Button>

            <!-- Apply Button -->
            <Button Style="{StaticResource OkButton}"
                    Width="110"
                    Command="{Binding CreateCommand}">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="✔" FontSize="14" Margin="0,0,6,0"/>
                    <TextBlock Text="Apply"/>
                </StackPanel>

                <!-- Click Feedback Animation -->
                <Button.Triggers>
                    <EventTrigger RoutedEvent="Button.Click">
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                 To="0.7"
                                                 Duration="{StaticResource AnimationDuration}"
                                                 AutoReverse="True"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                </Button.Triggers>
            </Button>
        </StackPanel>
    </Grid>
</Window>